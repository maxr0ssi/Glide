(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();class l{constructor(e="ws://127.0.0.1:8765/hud"){this.url=e,this.ws=null,this.reconnectTimer=null,this.eventHandlers=new Map}connect(e){const o=e?`${this.url}?token=${e}`:this.url;try{this.ws=new WebSocket(o),this.ws.onopen=()=>{console.log("WebSocket connected"),this.clearReconnectTimer()},this.ws.onmessage=s=>{try{const t=JSON.parse(s.data);this.handleEvent(t)}catch(t){console.error("Failed to parse message:",t)}},this.ws.onclose=()=>{console.log("WebSocket disconnected"),this.scheduleReconnect()},this.ws.onerror=s=>{console.error("WebSocket error:",s)}}catch(s){console.error("Failed to connect:",s),this.scheduleReconnect()}}on(e,o){this.eventHandlers.set(e,o)}handleEvent(e){const o=this.eventHandlers.get(e.type);o&&o(e)}scheduleReconnect(){this.clearReconnectTimer(),this.reconnectTimer=setTimeout(()=>{console.log("Attempting to reconnect..."),this.connect()},2e3)}clearReconnectTimer(){this.reconnectTimer!==null&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}disconnect(){this.clearReconnectTimer(),this.ws&&(this.ws.close(),this.ws=null)}}class c{constructor(){this.hudElement=document.getElementById("hud"),this.arrowUp=document.querySelector(".arrow-up"),this.arrowDown=document.querySelector(".arrow-down"),this.speedBars=document.querySelectorAll(".speed-bar");const o=new URLSearchParams(window.location.search).get("token")||void 0;this.wsClient=new l,this.setupEventHandlers(),this.wsClient.connect(o)}setupEventHandlers(){this.wsClient.on("scroll",e=>{this.showHUD(),this.updateDirection(e.vy),this.updateSpeed(e.speed)}),this.wsClient.on("hide",()=>{this.hideHUD()}),this.wsClient.on("config",e=>{this.updatePosition(e.position),this.updateOpacity(e.opacity)})}showHUD(){this.hudElement.classList.remove("hidden")}hideHUD(){this.hudElement.classList.add("hidden")}updateDirection(e){this.arrowUp.classList.remove("active"),this.arrowDown.classList.remove("active"),e<0?this.arrowUp.classList.add("active"):e>0&&this.arrowDown.classList.add("active")}updateSpeed(e){const o=Math.ceil(e*this.speedBars.length);this.speedBars.forEach((s,t)=>{t<o?s.classList.add("active"):s.classList.remove("active")})}updatePosition(e){this.hudElement.style.removeProperty("top"),this.hudElement.style.removeProperty("bottom"),this.hudElement.style.removeProperty("left"),this.hudElement.style.removeProperty("right"),this.hudElement.style.removeProperty("transform");const[o,s]=e.split("-");o==="top"?this.hudElement.style.top="40px":this.hudElement.style.bottom="40px",s==="left"?this.hudElement.style.left="40px":s==="right"?this.hudElement.style.right="40px":s==="center"&&(this.hudElement.style.left="50%",this.hudElement.style.transform="translateX(-50%)")}updateOpacity(e){this.hudElement.style.opacity=e}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>new c):new c;
